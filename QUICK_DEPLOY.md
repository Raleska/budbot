# ‚ö° –ë—ã—Å—Ç—Ä–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ Ubuntu

–ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –±–æ—Ç–∞ –Ω–∞ Ubuntu —Å–µ—Ä–≤–µ—Ä–µ —Å –¥–æ–º–µ–Ω–æ–º –æ—Ç Reg.ru.

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º

‚úÖ –î–æ–º–µ–Ω —Å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º–∏ A –∑–∞–ø–∏—Å—è–º–∏ –Ω–∞ –≤–∞—à IP  
‚úÖ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –æ—Ç Reg.ru (–∏–ª–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –ø–æ–ª—É—á–∏—Ç—å –æ—Ç Let's Encrypt)  
‚úÖ –î–æ—Å—Ç—É–ø –ø–æ SSH –∫ —Å–µ—Ä–≤–µ—Ä—É —Å –ø—Ä–∞–≤–∞–º–∏ root  
‚úÖ Telegram Bot Token –æ—Ç @BotFather  

## üöÄ –®–∞–≥–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Git (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@–≤–∞—à_—Å–µ—Ä–≤–µ—Ä_ip

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
# –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–ª–æ–Ω–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–∑ GitHub
cd /opt
chmod +x telegram-bot/deploy/*.sh
sudo ./telegram-bot/deploy/deploy-full.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
- –ö–ª–æ–Ω–∏—Ä—É–µ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–∑ GitHub
- –ù–∞—Å—Ç—Ä–æ–∏—Ç SSL (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Node.js
- –ù–∞—Å—Ç—Ä–æ–∏—Ç –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- –ó–∞–ø—É—Å—Ç–∏—Ç –±–æ—Ç–∞

### –í–∞—Ä–∏–∞–Ω—Ç 2: –†—É—á–Ω–æ–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh root@–≤–∞—à_—Å–µ—Ä–≤–µ—Ä_ip

# 2. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
cd /opt
git clone https://github.com/Raleska/budbot.git telegram-bot
cd telegram-bot

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
chmod +x deploy/*.sh
sudo ./deploy/deploy-full.sh
```

–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç:
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫—É Node.js, PM2, Nginx
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫—É SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ –æ—Ç Reg.ru
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
- ‚úÖ –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
- ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫—É –≤–µ–±—Ö—É–∫–∞

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–∫—Ä–∏–ø—Ç–∞ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è —Ñ–∞–π–ª `.env` –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ:

```env
BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather
USE_DATABASE=true
USE_WEBHOOK=true
WEBHOOK_URL=https://hyalpharmbot.ru
WEBHOOK_SECRET_TOKEN=—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ_—á–µ—Ä–µ–∑_openssl_rand_-hex_32
DB_PASSWORD=–≤–∞—à_–ø–∞—Ä–æ–ª—å_postgresql
```

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –±–æ—Ç–∞
pm2 status

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
pm2 logs telegram-bot

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ–±—Ö—É–∫–∞
npm run webhook:info

# –ü—Ä–æ–≤–µ—Ä–∫–∞ health check
curl https://hyalpharmbot.ru/health
```

## üîí –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSL –æ—Ç Reg.ru

–ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –Ω–µ –Ω–∞—Å—Ç—Ä–æ–∏–ª SSL –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

1. **–°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã –∏–∑ –ø–∞–Ω–µ–ª–∏ Reg.ru:**
   - –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (Certificate)
   - Private Key
   - –ö–æ—Ä–Ω–µ–≤–æ–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å)

2. **–ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:**
   ```bash
   scp certificate.crt root@—Å–µ—Ä–≤–µ—Ä:/etc/nginx/ssl/hyalpharmbot.ru/
   scp private.key root@—Å–µ—Ä–≤–µ—Ä:/etc/nginx/ssl/hyalpharmbot.ru/
   ```

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SSL:**
   ```bash
   chmod +x deploy/setup-regru-ssl.sh
   sudo ./deploy/setup-regru-ssl.sh
   ```

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞

–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub:

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
ssh root@–≤–∞—à_—Å–µ—Ä–≤–µ—Ä_ip
sudo ./deploy/deploy-update.sh
```

–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:

```bash
cd /opt/telegram-bot
sudo -u botuser git pull
sudo -u botuser npm install  # –µ—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
sudo -u botuser pm2 restart telegram-bot
```

## üìö –ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–º. `DEPLOYMENT.md` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π.
